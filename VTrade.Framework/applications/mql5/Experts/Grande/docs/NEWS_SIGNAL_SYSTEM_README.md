# Grande Calendar AI (FinBERT-only)

This document now focuses on the calendar analyzer. The legacy news signal system has been removed in this build. Calendar signals are generated by a FinBERT-only analyzer.

## üöÄ Features

- **Multi-Source News Fetching**: MarketAux, Alpha Vantage, NewsAPI
- **Advanced Sentiment Analysis**: MCP-based sentiment server with FinBERT support
- **Intelligent Signal Generation**: Combines sentiment with technical analysis
- **Risk Management**: Built-in position sizing and stop-loss calculation
- **Real-time Processing**: Continuous news monitoring and signal updates
- **MQL5 Integration**: Native MetaTrader 5 Expert Advisor support

## üìÅ System Components

### MQL5 Modules
- `GrandeNewsSentimentAnalyzer.mqh` - Core sentiment analysis engine
- `GrandeNewsFetcher.mqh` - News data fetching from multiple sources
- `GrandeNewsSignalGenerator.mqh` - Complete signal generation pipeline
- `GrandeNewsSignalDemo.mq5` - Demonstration Expert Advisor

### Python Components
- `mcp/analyze_sentiment_server/` - FinBERT calendar analyzer and sentiment server
- `mcp/analyze_sentiment_server/finbert_calendar_analyzer.py` - FinBERT-only calendar tool

## üõ†Ô∏è Installation & Setup

### 1. MQL5 Setup

1. Copy all `.mqh` files to your MetaTrader 5 `MQL5/Include/` directory
2. Copy `GrandeNewsSignalDemo.mq5` to your `MQL5/Experts/` directory
3. Compile the Expert Advisor in MetaEditor

### 2. Python Environment Setup

```bash
# Navigate to the mcp directory
cd mcp

# Create virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies (FinBERT only)
pip install -r requirements.txt
```

### 3. API Keys Configuration

Set up your API keys as environment variables:

```bash
# For news sources
export MARKETAUX_API_KEY="your_marketaux_key"
export ALPHA_VANTAGE_API_KEY="your_alpha_vantage_key"
export NEWSAPI_KEY="your_newsapi_key"

# For sentiment server
export OPENAI_BASE_URL="http://localhost:11434/v1"  # For Ollama
export OPENAI_API_KEY="EMPTY"
export SENTIMENT_PROVIDER="openai_compat"  # or "finbert_local"
```

### 4. Start the Sentiment Server

```bash
cd mcp/analyze_sentiment_server
python main.py
```

## üéØ Usage

### Basic Usage

1. **Start the Sentiment Server**:
   ```bash
   cd mcp/analyze_sentiment_server
   python main.py
   ```

2. **Run Calendar Analysis** (Python):
   ```bash
   python mcp/analyze_sentiment_server/finbert_calendar_analyzer.py
   ```

3. **Use in MetaTrader 5**:
   - Attach `GrandeNewsSignalDemo` to any chart
   - Configure input parameters
   - Enable auto-signal generation

### Advanced Configuration

#### News Signal Generator Parameters

```mql5
// News fetching configuration
input bool InpEnableMarketAux = true;
input string InpMarketAuxKey = "your_key";
input bool InpEnableAlphaVantage = true;
input string InpAlphaVantageKey = "your_key";

// Signal generation settings
input double InpMinSignalStrength = 0.6;
input double InpMinSignalConfidence = 0.5;
input int InpSignalValidityHours = 4;
input bool InpUseTechnicalConfirmation = true;
input bool InpUseRiskManagement = true;
```

#### Sentiment Analysis Configuration

```mql5
// Sentiment thresholds
double strong_positive_threshold = 0.6;
double positive_threshold = 0.2;
double negative_threshold = -0.2;
double strong_negative_threshold = -0.6;

// Confidence settings
double min_confidence = 0.3;
double high_confidence = 0.7;
int min_articles_for_signal = 3;
```

## üìä Signal Types

The system generates the following signal types:

- **STRONG_BUY**: Very positive sentiment (‚â•0.6) with high confidence (‚â•0.7)
- **BUY**: Positive sentiment (‚â•0.2)
- **NEUTRAL**: Neutral sentiment (-0.2 to 0.2)
- **SELL**: Negative sentiment (‚â§-0.2)
- **STRONG_SELL**: Very negative sentiment (‚â§-0.6) with high confidence (‚â•0.7)
- **NO_SIGNAL**: Insufficient data or low confidence

## üîß API Integration

### MarketAux API
- **Endpoint**: `https://api.marketaux.com/v1/news/all`
- **Features**: Entity sentiment, symbol filtering, real-time news
- **Rate Limits**: Varies by plan
- **Documentation**: [MarketAux Docs](https://www.marketaux.com/documentation)

### Alpha Vantage API
- **Endpoint**: `https://www.alphavantage.co/query`
- **Features**: News sentiment analysis, financial news
- **Rate Limits**: 5 calls per minute, 500 per day
- **Documentation**: [Alpha Vantage Docs](https://www.alphavantage.co/documentation/)

### NewsAPI
- **Endpoint**: `https://newsapi.org/v2/everything`
- **Features**: Global news coverage, multiple languages
- **Rate Limits**: 1000 requests per day
- **Documentation**: [NewsAPI Docs](https://newsapi.org/docs)

## üß† Sentiment Analysis

### MCP Sentiment Server
The system uses a Model Context Protocol (MCP) server for sentiment analysis with multiple backends:

1. **OpenAI-Compatible**: Works with Ollama, vLLM, NIM
2. **FinBERT Local**: Financial sentiment model
3. **Custom Classifier**: External sentiment API

### Sentiment Scoring
- **Range**: -1.0 (very negative) to +1.0 (very positive)
- **Confidence**: 0.0 (no confidence) to 1.0 (high confidence)
- **Time Decay**: Recent news weighted more heavily

## üìà Signal Generation Process

1. **News Fetching**: Retrieve latest news from configured sources
2. **Sentiment Analysis**: Analyze each article's sentiment
3. **Aggregation**: Calculate weighted average sentiment
4. **Technical Confirmation**: Optional technical analysis validation
5. **Risk Management**: Apply position sizing and stop-loss rules
6. **Signal Validation**: Ensure signal meets quality thresholds

## üõ°Ô∏è Risk Management

### Position Sizing
- **Risk Per Trade**: Configurable percentage of account balance
- **Maximum Position Size**: Limits maximum exposure
- **ATR-Based Stops**: Dynamic stop-loss based on volatility

### Signal Validation
- **Minimum Strength**: Ensures signal quality
- **Minimum Confidence**: Requires reliable sentiment data
- **Time Validity**: Signals expire after configured hours
- **Market Hours**: Respects trading session times

## üìä Performance Monitoring

The system tracks:
- **Signal Count**: Total signals generated
- **Success Rate**: Percentage of profitable signals
- **Confidence Metrics**: Average confidence levels
- **Source Performance**: Individual API source effectiveness

## üîç Troubleshooting

### Common Issues

1. **No Signals Generated**:
   - Check API keys are valid
   - Verify minimum article requirements
   - Ensure sentiment thresholds are reasonable

2. **Low Signal Quality**:
   - Increase minimum confidence threshold
   - Require more articles for signal generation
   - Enable technical confirmation

3. **API Rate Limits**:
   - Reduce update frequency
   - Use fewer news sources
   - Implement request queuing

### Debug Mode

Enable detailed logging:
```mql5
input bool InpShowDetailedLogs = true;
```

## üöÄ Advanced Usage

### Custom News Sources
Add new news sources by extending the `CGrandeNewsFetcher` class:

```mql5
NewsFetchResult FetchFromCustomSource()
{
    // Implement custom news fetching logic
    // Return NewsFetchResult with success status
}
```

### Custom Sentiment Analysis
Implement custom sentiment analysis by modifying the `AnalyzeWithFallback` method:

```mql5
bool AnalyzeWithCustomMethod(NewsArticle &article)
{
    // Implement custom sentiment analysis
    // Update article.sentiment_score and article.confidence
}
```

### Integration with Existing Systems
The system can be integrated with existing trading systems:

```mql5
// In your main trading logic
TradingSignal signal = g_news_signal_generator.GenerateTradingSignal();
if(signal.is_valid && signal.sentiment_signal == NEWS_SIGNAL_STRONG_BUY)
{
    // Execute buy order
    ExecuteBuyOrder(signal.entry_price, signal.stop_loss, signal.take_profit);
}
```

## üìù Example Output

```
=== GRANDE NEWS SIGNAL ANALYSIS RESULTS ===
Timestamp: 2024-01-15T10:30:00
Symbols: EURUSD, GBPUSD, USDJPY, AUDUSD, USDCAD
Signal: STRONG_BUY
Strength: 0.750
Confidence: 0.820
Articles Analyzed: 12
Reasoning: Based on 12 articles. Avg sentiment: 0.750, Confidence: 0.820

Top Articles:
1. EUR/USD Reaches New Highs on Economic Optimism...
   Source: forex.com
   Sentiment: Positive (0.850)

2. Central Bank Policy Shifts Impact Currency Markets...
   Source: reuters.com
   Sentiment: Positive (0.720)

3. Inflation Data Drives Forex Market Sentiment...
   Source: bloomberg.com
   Sentiment: Positive (0.680)
```

## ü§ù Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests if applicable
5. Submit a pull request

## üìÑ License

Copyright 2024, Grande Tech. All rights reserved.

## üÜò Support

For support and questions:
- Check the troubleshooting section
- Review the MQL5 documentation
- Contact Grande Tech support

---

**Disclaimer**: This system is for educational and research purposes. Always test thoroughly before using in live trading. Past performance does not guarantee future results.
